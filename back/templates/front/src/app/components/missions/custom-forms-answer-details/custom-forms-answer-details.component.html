<div class="space-y-6">
  @if (customFormsData().length > 0) {
    @for (customForm of customFormsData(); track customForm.id) {
      <div class="overflow-hidden rounded-lg border border-slate-200 bg-white shadow-sm">
        <!-- En-tête du formulaire -->
        <div class="border-b border-slate-100 bg-slate-50 px-6">
          <div class="flex items-center gap-3">
            <div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-100">
              <mat-icon class="text-blue-600" style="font-size: 18px">assignment</mat-icon>
            </div>
            <h3 class="text-lg font-semibold text-slate-800">
              {{ customForm.name || 'Formulaire personnalisé' }}
            </h3>
          </div>
        </div>

        <!-- Contenu du formulaire -->
        <div class="p-6">
          @if (customForm.formStructure && customForm.formStructure.sections) {
            @for (section of customForm.formStructure.sections; track section.id) {
              <div class="mb-8 last:mb-0">
                <!-- Titre de la section -->
                <div class="mb-4">
                  <h4 class="text-md border-l-4 border-blue-500 pl-3 font-medium text-slate-700">
                    Section {{ $index + 1 }}
                  </h4>
                </div>

                <!-- Champs de la section -->
                @if (section.fields) {
                  <div class="grid gap-6 lg:grid-cols-2">
                    @for (field of section.fields; track field.id) {
                      @if (section.id && field.id && customForm.id) {
                        <div class="space-y-1">
                          <app-custom-form-field
                            [field]="field"
                            [answerValue]="getFieldValueFromSignal(customForm, section.id, field.id)"
                            [editMode]="editMode()"
                            [firstNextClicked]="false"
                            (answerValueChange)="onCustomFormFieldChange(customForm.id!, section.id!, $event)"
                          ></app-custom-form-field>
                        </div>
                      }
                    }
                  </div>
                }
              </div>
            }
          }
        </div>
      </div>
    }
  } @else {
    <div
      class="flex flex-col items-center justify-center gap-2 rounded-lg border border-slate-200 bg-white p-8 text-center"
    >
      <mat-icon class="text-slate-400">assignment</mat-icon>
      <span class="text-lg font-medium text-slate-700">Aucun formulaire personnalisé</span>
      <p class="text-slate-500">Aucun formulaire personnalisé n'est associé à ce type de mission.</p>
    </div>
  }
</div>
